# Command Pattern

**캡슐화 수준을 더 높은 수준으로**
**메소드 호출을 캡슐화**

## 협력 업체 클래스

---

- 상당히 많은 객체의 인터페이스
    - 공통적인 인터페이스의 부재…
    - 앞으로도 여러 인터페이스가 추가될 수 있음.

## 커맨드 패턴

---

**작업을 요청하는 쪽과 그 작업을 처리하는 쪽을 분리**

- **커맨드 객체**를 추가하여 작업
    - 특정 객체에 관한 특정 작업요청을 캡슐화.
- 패턴이 어떻게 돌아가는지 파악하기 어려움.

### 주문하는 과정

- **주문서는 주문 내용을 캡슐화**
    - 주문서는 주문 내용을 요구하는 객체
    - 식사 준비에 필요한 `orderUp()` 메소드와 주방장 레퍼런스만 들어있음.
    - 주문을 받으면 주방장 레퍼런스에게 `orderUP()`을 호출해주기만 하면 됨.
- **종업원은 주문서를 받고 `orderUp()` 호출**
    - orderUp() 메소드를 호출하는 객체.
    - 주문서의 내용, 주방장이 누구인지. ⇒ 아무 관심 없음.
    - `takeOrder()` 메소드에는 여러 고객의 주문서를 매개변수로 전달.
- **주방장은 식사를 준비하는데 필요한 정보**
    - 식사 준비 방법은 주방장만 알고 있음.

### 용어정리

- Client
    - 커맨드 객체 생성.
- Command
    - 리시버에게 전달할 행동 구성
    - 리시버에게 행동 처리.(`execute()` 호출)
- Invoker
    - 커맨드 객체 쓰이기 전까지 보관.
- Receiver
    - 행동 메소드 실행.

### 첫번째 커맨드 객체 만들기

- **커맨드 인터페이스 구현**
    - 모두 같은 인터페이스 구현.
    - `execute()` 메소드 정의
- **조명을 켤 때 필요한 커맨드 클래스 구현**
    - `LightOnCommand` 클래스 구현
        - 특정 커맨드 객체로 제어할 클래스의 인터페이스 전달.(light 인터페이스)
    - `execute()` 메소드 오버라이드

### 커맨드 객체 사용하기

- 연결 슬롯과 실행슬롯 정의.
- `RemoteControlTest` 클래스는 클라이언트
- `remote` 변수는 인보커
- `light` 클래스는 리시버
- `lightOn`은 커맨드 객체
- 커맨드 객체를 인보커에게 전달
- 커맨드 객체 실행

## 커맨드 패턴 정의

---

<aside>
💡 **커맨드 패턴**을 사용하면 **요청 내역을 객체로 캡슐화**해서 **객체를 서로 다른 요청 내역에 따라 매개변수화** 가능.

</aside>

- 커맨드 객체는 일련의 행동을 특정 리시버와 연결. 요청을 캡슐화
- 후에 메타 커맨드 패턴 ⇒ 여러개의 명령을 매크로로 한번에 실행 가능.

### 클래스 다이어그램 살펴보기

![Untitled](Command%20Pattern%2087b214a37c374fabb6dfa8d6a31d6d82/Untitled.png)

- `Client`는 `ConcreteCommand`를 생성하고 `Receiver`를 설정
- `Invoker`는 명령이 들어 있으며 `execute()` 호출로 커맨드 객체에게 특정 작업 수행 가능
- `Command`는 모든 커맨드 객체가 구현해야하는 인터페이스
    - execute()로 메소드 호출
    - 리시버에게 특정 작업을 처리하라는 지시 전달.
- `Receiver`는 요구사항을 수행할때 어떤 일을 처리해야 할 지.
- `ConcreteCommand`는 특정 행동과 리시버를 연결
    - `Invoker`에서 `execute()` 호출로 요청하면 `ConcreteCommand` 객체에서 리시버의 메소드를 호출. 작업 처리.

## 확장

---

<aside>
💡 **NoCommand 객체**
NoCommand 객체는 일종의 null 객체. 널 객체는 딱히 리턴할 객체도 없고 클라이언트가 null을 처리하지 않게 하고 싶을 때 활용하면 좋음.

</aside>

**람다 표현식을 이용하면 구상 커맨드 객체를 생성하는 단계를 건너뛸 수 있음.**

```java
/*
 * ... other
 */

remoteControl.setCommand(0, () -> livingRoomLight.on(), 
														() -> livingRoomLight.off());

/*
 * ...
 */
```

- Command 인터페이스에 추상 메소드가 하나뿐일 때만 사용 가능.

## 작업 취소 기능

---

- interface Command에 `undo()`메소드 추가
